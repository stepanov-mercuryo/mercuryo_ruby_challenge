# Mercuryo Ruby Challenge

## Описание задания

Необходимо реализовать сервис аккаунтинга, который ведет учет балансов и транзакций.

## Требования

Сервис должен поддерживать:

1. **Пополнение баланса** - одностадийная атомарная операция, которая сразу завершается и обновляет баланс аккаунта.

2. **Списание с баланса** - двухстадийная операция:
   - Первая стадия: резервирование средств (создание транзакции со статусом `pending`)
   - Вторая стадия: подтверждение или отмена списания (изменение статуса на `completed` или `cancelled`)

### Требования к производительности

Сервис должен быть рассчитан на высокую нагрузку:
- Количество аккаунтов: тысячи
- Объем транзакций: десятки миллионов записей

### Структура базы данных

#### Таблица `accounts`
- `id` (primary key)
- `balance` (decimal) - текущий баланс аккаунта, 2 десятичных знака
- `currency` (string) - валюта аккаунта
- `created_at` (timestamp)
- `updated_at` (timestamp)

#### Таблица `transactions`
- `id` (primary key)
- `account_id` (foreign key -> accounts.id)
- `currency` (string) - валюта транзакции
- `amount` (decimal) - сумма транзакции (может быть положительной для пополнения и отрицательной для списания)
- `status` (string) - статус транзакции:
  - `pending` - транзакция в процессе (для двухстадийного списания)
  - `completed` - транзакция завершена успешно
  - `cancelled` - транзакция отменена
- `uuid` (string, unique) - уникальный идентификатор транзакции
- `transaction_type` (string) - тип транзакции: `deposit` (пополнение) или `withdrawal` (списание)
- `created_at` (timestamp)
- `updated_at` (timestamp)